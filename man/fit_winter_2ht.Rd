% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/winter_2ht.R
\name{fit_winter_2ht}
\alias{fit_winter_2ht}
\title{Winter et al. (2022) Two-High Threshold (2-HT) MPT Model for Eyewitness Identification}
\usage{
fit_winter_2ht(
  data,
  lineup_size = 6,
  target_present = NULL,
  identification = NULL,
  start_params = NULL,
  method = "L-BFGS-B",
  ...
)
}
\arguments{
\item{data}{A data frame with lineup identification data, OR a named vector/list
of counts with the following elements:
- n_tp_suspect: Number of suspect IDs in target-present (TP) lineups
- n_tp_filler: Number of filler IDs in TP lineups
- n_tp_reject: Number of rejections in TP lineups
- n_ta_suspect: Number of suspect IDs in target-absent (TA) lineups
- n_ta_filler: Number of filler IDs in TA lineups
- n_ta_reject: Number of rejections in TA lineups}

\item{lineup_size}{Size of the lineup (L). Default is 6.}

\item{target_present}{Column name indicating target presence (TRUE/FALSE) if data is a data frame.}

\item{identification}{Column name for identification decision if data is a data frame.
Should contain "suspect", "filler", or "reject".}

\item{start_params}{Optional named vector of starting parameter values (dP, dA, b, g).
If NULL, uses reasonable defaults.}

\item{method}{Optimization method. Default is "L-BFGS-B" for bounded optimization.}

\item{...}{Additional arguments passed to optim().}
}
\value{
An object of class "winter_2ht" containing:
  \item{parameters}{Estimated parameters (dP, dA, b, g)}
  \item{se}{Standard errors of parameter estimates}
  \item{loglik}{Log-likelihood of the fitted model}
  \item{aic}{Akaike Information Criterion}
  \item{bic}{Bayesian Information Criterion}
  \item{fitted_probs}{Model-predicted probabilities for each outcome}
  \item{observed_counts}{Observed counts}
  \item{expected_counts}{Expected counts under the model}
  \item{lineup_size}{Lineup size used}
  \item{convergence}{Convergence code from optim}
  \item{n_total}{Total sample size}
}
\description{
Fits the 2-HT multinomial processing tree (MPT) model to lineup identification data.
This model separates detection-based processes (dP, dA) from non-detection-based
processes (biased selection b, guessing-based selection g) using the full 2x3
outcome structure of lineup procedures.
}
\details{
The 2-HT model (Winter, Menne, Bell, & Buchner, 2022) uses four parameters:
\itemize{
  \item \strong{dP}: Probability of detecting culprit presence (0 to 1)
  \item \strong{dA}: Probability of detecting culprit absence (0 to 1)
  \item \strong{b}: Probability of biased suspect selection (0 to 1)
  \item \strong{g}: Probability of guessing-based selection (0 to 1)
}

Model equations for culprit-present lineups:
\itemize{
  \item P(suspect ID) = dP + (1-dP) * [b + (1-b) * g * (1/L)]
  \item P(filler ID) = (1-dP) * (1-b) * g * ((L-1)/L)
  \item P(reject) = (1-dP) * (1-b) * (1-g)
}

Model equations for culprit-absent lineups:
\itemize{
  \item P(suspect ID) = (1-dA) * [b + (1-b) * g * (1/L)]
  \item P(filler ID) = (1-dA) * (1-b) * g * ((L-1)/L)
  \item P(reject) = dA + (1-dA) * (1-b) * (1-g)
}
}
\examples{
\dontrun{
# Example 1: Using count data directly
counts <- c(
  n_tp_suspect = 147, n_tp_filler = 94, n_tp_reject = 141,
  n_ta_suspect = 38, n_ta_filler = 138, n_ta_reject = 206
)
fit <- fit_winter_2ht(counts, lineup_size = 6)
print(fit)
summary(fit)

# Example 2: Using a data frame
# Assuming you have data with columns 'target_present' and 'identification'
fit <- fit_winter_2ht(
  lineup_data,
  lineup_size = 6,
  target_present = "target_present",
  identification = "identification"
)
}

}
\references{
Winter, K., Menne, N. M., Bell, R., & Buchner, A. (2022). Experimental validation
of a multinomial processing tree model for analyzing eyewitness identification
decisions. Scientific Reports, 12, 15571. https://doi.org/10.1038/s41598-022-19513-w
}
