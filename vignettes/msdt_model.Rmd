---
title: "mSDT: Multi-Item Signal Detection Theory"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{mSDT: Multi-Item Signal Detection Theory}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(collapse = TRUE, comment = "#>")
```

# Overview

This vignette introduces core utilities for the **multi-item SDT (mSDT)** model
(Yang, Burke, & Healy, 2025), focusing on components that are mathematically
well-defined under the equal-variance, independent filler assumptions.

Key features:

- The **max filler distribution** for (m - 1) independent standard normal fillers
- **Parameter estimation** from rejection rates in culprit-absent and culprit-present lineups
- **Joint distribution visualization** (suspect vs. max filler)

# Max filler distribution

```{r}
library(r4lineups)

dmax_filler(0, lineup_size = 6)
pmax_filler(0, lineup_size = 6)
qmax_filler(0.5, lineup_size = 6)
```

Moments are computed numerically:

```{r}
max_filler_moments(6)
```

# Estimating mSDT parameters from rejection rates

Let

- \(Pr(REJ\mid I)\) = rejection rate in culprit-absent lineups
- \(Pr(REJ\mid G)\) = rejection rate in culprit-present lineups

Then (Yang et al., 2025):

- \(Pr(REJ\mid I) = \Phi(\gamma)^m\)
- \(Pr(REJ\mid G) = \Phi(\gamma - d')\,\Phi(\gamma)^{m-1}\)

Use the helper:

```{r}
estimate_msdt_params(pr_rej_I = 0.25, pr_rej_G = 0.15, lineup_size = 6)
```

# Joint distribution plots

```{r}
plot_msdt_joint(dprime = 1.2, gamma = 0.4, lineup_size = 6,
                lineup_type = "culprit_present")
```

```{r}
plot_msdt_joint(dprime = 1.2, gamma = 0.4, lineup_size = 6,
                lineup_type = "culprit_absent")
```

# Notes

These functions implement the **core** mSDT assumptions (equal variance,
independent filler signals). Correlated signals, unequal variances, and other
extensions discussed in the paper are not yet implemented and should be treated
as experimental extensions.
